@page "/supportfiles"


@code {
    private const string Url = "/supportfiles/";
    public static string GetRedirectUrl() => Url;
}

<PageTitle>Supportakten Übersicht</PageTitle>

<SupportfileOverviewDataGrid @ref="_supportfileOverviewDataGrid"/>

@code {
    [CascadingParameter] public UserAccessService UserAccessService { get; set; }
    private bool _isAuthorized;
    private bool _shouldRedirect;

    private SupportfileOverviewDataGrid _supportfileOverviewDataGrid;
    
    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        _isAuthorized = UserAccessService.HasRight(RightEnum.ViewSupportfiles);
        _shouldRedirect = !_isAuthorized;
    }
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;

        if (_shouldRedirect)
        {
            Navigation.NavigateToNotAuthorized();
            return;
        }

        await _supportfileOverviewDataGrid.Load();
    }
}